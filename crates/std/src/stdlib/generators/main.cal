const suspend = fn <T> (value : T) -> T => try gen_suspend(value) as T => value;

impl<T> Iter for gen:<T> {
	type Item = T;

	const next = fn (self : &mut gen:<T>) -> T? => {
		if self.done => return none;
		let value = (self.data)();
		if value == none => {
			self.done = true;
			return none;
		};
		
		self.index = self.index + 1;
		value;
	};
};

impl<T> gen:<T> {
	const iter = fn (self : gen:<T>) -> gen:<T> => self;

	const into_iter = fn (self : gen:<T>) -> gen:<T> => self;
};