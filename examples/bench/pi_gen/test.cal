const pi_terms_gen = fn (n_terms : int) -> gen:<float> => {
	let mut i = 0;
	let mut denominator = 1f;
	let mut operation = 1f;
	
	for i < n_terms => {
		return operation * (4f / denominator);
		
		denominator += 2f;
		operation *= -1f;
		i += 1;
	};
};

const calculate_pi_gen = fn (n_terms : int) -> float => {
	let mut pi = 0f;
	let mut it = pi_terms_gen(n_terms);
	
	for let .Some : term <- it.next() => {
		pi += term;
	};
	
	pi;
};

const main = fn () => {
	let n = 100_000;
	let result = calculate_pi_gen(n);
	print(result);
};

bench pi_gen => main();

test pi_gen_small => {
	let pi = calculate_pi_gen(1000);
	assert(pi > 3f && pi < 3.2, "pi approximation out of expected range");
};